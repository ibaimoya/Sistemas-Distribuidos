<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Registro</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />

  <style>
    /* Fondo degradado id√©ntico */
    body{margin:0;min-height:100vh;display:flex;justify-content:center;align-items:center;
         background:linear-gradient(to bottom,rgba(18,128,206,.864),rgba(9,126,198,.461));overflow:hidden;}

    /* Overlay blanco */
    #whiteFade{position:fixed;inset:0;background:#fff;opacity:1;
               transition:opacity 2s ease-in-out;pointer-events:none;z-index:1000;}

    /* Entrada tarjeta */
    @keyframes enterUp{from{transform:translateY(80px);opacity:0;}to{transform:translateY(0);opacity:1;}}
    .entrarCard{opacity:0;animation:enterUp 1s ease-in-out .2s forwards;}

    /* Salida tarjeta */
    @keyframes outDown{from{transform:translateY(0);opacity:1;}to{transform:translateY(80px);opacity:0;}}
    .salirCard{animation:outDown .3s ease-in forwards;}

    /* Flecha volver = mismo estilo que login */
    #backBtn {
      opacity: 0;
      animation: enterLeft 1s ease-in-out 0.5s forwards;
    }

    @keyframes enterLeft {
      from {
      transform: translateX(-80px);
      opacity: 0;
      }
      to {
      transform: translateX(0);
      opacity: 1;
      }
    }
    .btn-back{position:absolute;top:1rem;left:1rem;z-index:10;
              background:rgba(0,0,0,.25);border:none;border-radius:50%;
              width:42px;height:42px;display:flex;justify-content:center;align-items:center;
              color:#fff;font-size:1.6rem;transition:background .2s;}
    .btn-back:hover{background:rgba(0,0,0,.45);}

    /* Salida flecha */
    @keyframes outLeft{from{transform:translateX(0);opacity:1;}to{transform:translateX(-120%);opacity:0;}}
    .backExit{animation:outLeft .3s ease-in forwards;}

    /* Otros */
    .bg{background:url('/images/placeholder.png') center/cover no-repeat;}
    .btn-toggle-password{  
        min-width: 7rem;
        background-color: #ddd;
        border: 1px solid #aaa;}
    .error{color:red;font-size:14px;}
  </style>
</head>
<body>

  <!-- Overlay -->
  <div id="whiteFade"></div>

  <!-- Flecha volver -->
  <a href="/" class="btn-back fadeLink"><i class="bi bi-arrow-left-short"></i></a>

  <!-- Tarjeta registro -->
  <div id="cardReg" class="container w-75 rounded-4 shadow entrarCard">
    <div class="row">
      <div class="col bg d-none d-lg-block col-md-5 col-lg-5 col-xl-6 rounded-4"></div>

      <div class="col bg-white p-5 rounded-4">
        <h2 class="fw-bold text-center py-3">Reg√≠strate</h2>

        <form id="formRegistro" th:action="@{/register}" method="post">
          <div class="mb-3">
            <label for="usuario" class="form-label">Nombre de usuario</label>
            <input type="text" id="usuario" name="usuario" class="form-control">
            <div class="error" id="usuarioError"></div>
          </div>

          <div class="mb-3">
            <label for="email" class="form-label">Correo electr√≥nico</label>
            <input type="email" id="email" name="email" class="form-control">
            <div class="error" id="emailError"></div>
          </div>

          <div class="mb-3">
            <label for="password" class="form-label">Contrase√±a</label>
            <div class="input-group">
              <input type="password" id="password" name="password" class="form-control">
              <!-- gris clarito -->
              <button type="button" class="btn btn-light btn-toggle-password" onclick="togglePass(event,'password')">
                <span>üëÅ Mostrar</span>
              </button>
            </div>
            <div class="error" id="passError"></div>
          </div>

          <div class="mb-3">
            <label for="confirm" class="form-label">Repite la contrase√±a</label>
            <div class="input-group">
              <input type="password" id="confirm" name="confirm" class="form-control">
              <button type="button" class="btn btn-light btn-toggle-password" onclick="togglePass(event,'confirm')">
                <span>üëÅ Mostrar</span>
              </button>
            </div>
            <div class="error" id="confirmError"></div>
          </div>

          <div class="d-grid"><button class="btn btn-success">Crear cuenta</button></div>

          <div class="mt-3 text-end">
            <span>¬øYa tienes cuenta? <a th:href="@{/login}" class="fadeLink">Inicia sesi√≥n</a></span>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Fade-in -->
  <script>
    window.addEventListener('load',()=>{
      const o=document.getElementById('whiteFade');
      setTimeout(()=>o.style.opacity='0',100);
      setTimeout(()=>o.style.display='none',2100);
    });
  </script>

  <!-- Mostrar / ocultar contrase√±a -->
  <script>
    function togglePass(e,id){
      const input=document.getElementById(id);
      input.type=input.type==='password'?'text':'password';
      e.currentTarget.firstChild.textContent=input.type==='password'?'üëÅ Mostrar':'üôà Ocultar';
    }
  </script>

  <!-- Validaci√≥n externa -->
  <script src="/js/signUpValidation.js"></script>
  
  <!-- Fade-out -->
  <script>
    document.querySelectorAll('.fadeLink').forEach(link=>{
      link.addEventListener('click',function(e){
        e.preventDefault();
        document.querySelector('.btn-back').classList.add('backExit');
        document.getElementById('cardReg').classList.add('salirCard');

        const o=document.getElementById('whiteFade');
        o.style.display='block';o.style.opacity='0';void o.offsetWidth;o.style.opacity='1';

        setTimeout(()=>window.location.href=this.href,1500);
      });
    });
  </script>


  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>